I"2<p><em>This article supersedes the discussion of mod_spotlight_apple in the Web Technologies Admin Guide.</em></p>

<p>Mac OS X Server 10.4 no longer supports the Sherlock-based searching capability provided by the mod_sherlock_apple Apache module and the indexfolder command-line tool. The Spotlight-based mod_spotlight_apple Apache module replaces it. Like its predecessor, it allows web browsers to search the content of your website.</p>

<p>Note that the indexing function of Spotlight is disabled by default in Mac OS X Server 10.4. Thus if you want to provide Spotlght-based search capability for Web Service, you must take the following steps.</p>

<h3 id="enable-spotlight-indexing">Enable Spotlight indexing</h3>
<p>To enable indexing for a volume, use the mdutil tool in Terminal. For example, to enable it on the root volume:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mdutil <span class="nt">-i</span> on /
</code></pre></div></div>

<p>See the man page for mdutil(1) for further information. Note that there may be performance implications. Indexing must remain enabled for the Spotlight Web Search facility to operate.</p>

<h3 id="import-content">Import content</h3>
<p>Next, import your web content into the Spotlight MetaData store. The /Library/WebServer/Documents folder is not normally monitored by the MetaData Import processes, so you will need to manually import it, both initially and whenever you want any changes to be reflected. It‚Äôs a good practice to create a different folder or folders to hold the contents of your virtual hosts; you‚Äôll need to manually import and update those as well.</p>

<p>This is done with the mdimport command-line tool:</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>mdimport <span class="nt">-f</span> /Library/WebServer/Documents/example-vhost/
</code></pre></div></div>

<p>The ‚Äú-f‚Äù option is necessary to force the mdimport tool to process the contents of the specified folder. Note that it may take some time to import large volumes of content. See the man page for mdimport(1) for more detail.</p>

<p>A variety of mdimporter extensions are pre-installed for most common content formats. If you have custom document formats, they may not be supported.</p>

<h3 id="in-server-admin">In Server Admin‚Ä¶</h3>
<p>Enable the mod_spotlight_apple module in Server Admin‚Äôs Web panel, and make sure Web Service is enabled. As always, it‚Äôs a good idea to make sure the Web Performance Cache is enabled only if you have a specific need for it.</p>

<h3 id="copy-the-templatespotlight-file">Copy the template.spotlight file</h3>
<p>Copy the template.spotlight file from /Library/WebServer/Documents into the Document Root of each virtual host for which you want the spotlight search to be available. You may customize the title, maximum allowed hits, and other aspects of the presentation by modifying the copy of this file.</p>

<h3 id="access-from-clients">Access from clients</h3>
<p>To access the search capability, instruct your web clients to append ‚Äú.spotlight‚Äù to the URL for your virtual hosts, like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://vhost1.example.com/.spotlight
</code></pre></div></div>

<p>This presents a simple search page that performs a content search on the contents of the DocumentRoot for the virtual host. Results are sorted with the most relevant hit first, although no relevance score is presented.</p>
:ET