---
layout: page
title: Инсталляция системы QNX4
---

Вы наверняка видели demodisk операционной системы QNX4. Если нет, то спешите попробовать его - вам понравится ( www.demodisk.com ) . И почти наверняка вы захотите поставить себе полную версию. На данный момент последняя версия 4.25C. На ее примере и описывается установка.

Для начала вам надо достать дистрибутив : 5 дискет + 1 загрузочная. Это сама система с набором базовых файлов. Ставится только с дискет. Образы дискет находятся в файле qnx4.25.pdiskset.tar.F. Эти образы сделаны командой cp image /dev/fd0 , поэтому если вы делаете образы не в Unix, у вас могут быть трудности. Для начала надо распаковать - ( инструкции для Dos/Windows )

```
C:\>freeze -id qnx4.25.pdiskset.tar.F (если у вас старая версия freeze, то используйте короткие имена файлов, а лучше скачайте новую версию freeze32 [ by Mike Gorchak ]).
C:\>tar xvf qnx4.25.pdiskset.tar (tar.exe лежит в архиве утилит)
```

В unix загрузочную дискету надо форматировать так : fdformat -k0 -z2 /dev/fd0 В противном случае при загрузке с этой дискеты возможны сбои. Устраняются сбои установкой меньшей частоты процессора ( для AMD предел - 200-233 Mhz ).

Теперь вам необходимо записать полученные файлы на дискеты. Для этого используется программа rawrite.

Если по каким-то причинам вы не используете эту программу, то возьмите Norton Disk Editor из комплекта Norton Utilities. В нем открывается файл с образом и с помощью [ Объект/Записать в .../Физические сектора/Диск А:/1.44Mb ] записывается на дискету.

Далее вам необходимо выделить место на жестком диске. Для средней установки надо около 100-150 мегабайт, если же вы планируете надстраивать систему, например ставить X-Windows, то чем больше тем лучше. Для разбиения диска рекомендуется использовать Partition Magic. Раздел надо делать unformatted. Делать раздел лучше всего на первом диске ( иначе будут сложности, и все равно придется ставить диск первым до первой перезагрузки ). Раздел должен быть primary.

Если вы хотите с этого диска загружать также другие ОС, то вам необходим менеджер операционных систем. Подойдет System Commander или SyMon . Если вы используете System Commander при установке активного раздела будьте внимательны - установите раздел на котором расположены файлы SC. QNX заменяет MBR, поэтому вам придется его обновлять.

После первой загрузки и входа в систему администратором ( root ) подключите диски Dos.

```shell
#Dosfsys -L
```

Эта команда автоматически подключит первый раздел вашего жесткого диска ( /dos/c ) и дискету ( /dos/a). Ключ -L означает, что мы хоти видет длиныые имена.

Следующий файл, который надо установить - патч системы. На данный момент последний патч для ядра 4.25 называется "С". Копируем с Dos-раздела патч.

```shell
#cp /dos/c/_patchC.tar.F /
```

Копируем в корень, оттуда будем ставить

```shell
#install -u _patchC.tar.F
```

Так в QNX выполняется установка файлов. Ключ -u означает распаковку. Если вы находитесть не в корневом каталоге, install порекомендует вам сменить его, т.к. распаковываться все может в текущий ( ./ ) каталог.

В ядро QNX вставлена возможность защиты от копирования программных продуктов. Защита выполняется на уровне лицензий, которые должны копировать в специальный файл, расположенный в /.licenses ( т.е. файл расположен в корневом каталоге - / и имеет имя .licenses ). Официально лицензию можно получить в фирме QSSL, указав при этом номер вашего продукта, указанного на коробке.

Если же вы не имеете этой коробки, то придется использовать следующий метод. С раздела Dos копируем патченный Proc32.( cksum: 2013672935 130615 Proc32 ).

При установке критичных файлов, особенно если вы их загружали через сеть, используйте для проверки файла утилиту cksum. Если у вас ее еще нету, то вы можете загрузить ее себе. Версия для Windows( в комплекте с другими полезными утилилитами) и для QNX.

```shell
#cp /dos/c/Proc32 /boot/sys
```

Теперь надо пересобрать ядро.

```shell
#cd /boot
# rm /images/hard.#
#make b=hard.#
#cp /.boot /.altboot
#cp images/hard.# /.boot
```

Вместо знака # ставим номер текущего узла, если вы работаете не в сети, то это 1. Ваше старое ядро сохранено в /.altboot, и теперь при нажатии на ESC во время загрузки ( "Press ESC to boot alternate OS.") будет загружаться оно. Это обязательно надо делать, т.к. если ядро будет испорчено, то система не загрузится. Тогда вам уже надо будет загружать систему с дискеты.

Теперь можно перезагружаться. 

```shell
#shutdown -f
```

Загружаемся, входим. Теперь можно ставить программное обеспечение, не опасаясь, что оно не заработает. Ну или почти не опасаясь :).

Первым делом ставим файловый менеджер под консоль - аналог Norton Commander под Dos.

```shell
#cp /dos/c/mqc21a.tgz /
#cd /
#gzip -d mqc21a.tgz
#tar xvf mqc21a.tar
#cd /bin
#ln -s mqc /mqc/2.1a/mqc
#ln -s med /mqc/2.1a/med
#mqc
```

Теперь вам надо создать пользователя, под которым вы будете работать

```shell
#passwd username
```

и установить пароль на пользователя root

```shell
#passwd
```

Теперь можно устанавливать софт: Photon, Voyager, Watcom C, TCP/IP etc...

Вход в MicroGUI Photon осуществляется коммандой

```shell
#ph
```

В принципе, пока все...
